<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GD Demon List - –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –≤ –∏—Å–ø—ã—Ç–∞–Ω–∏—è—Ö</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="logo-gradient">GD –¢–û–ü –ò–°–ü–´–¢–ê–ù–ò–ô</h1>
            <nav>
                <a href="index.html">–¢–æ–ø —É—Ä–æ–≤–Ω–µ–π</a>
                <a href="players.html">–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤</a>
                <a href="challenge-list.html">–°–ø–∏—Å–æ–∫ –∏—Å–ø—ã—Ç–∞–Ω–∏–π</a>
                <a href="challenge-top.html" class="active">–¢–æ–ø –∏—Å–ø—ã—Ç–∞–Ω–∏–π</a>
                <a href="verify.html">–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è</a>
                <a href="about.html">–û –Ω–∞—Å</a>
            </nav>
        </header>

        <main class="main-content">
            <div class="list-info">
                <h2>üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –≤ –∏—Å–ø—ã—Ç–∞–Ω–∏—è—Ö</h2>
                <p>–†–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –æ—á–∫–∞–º –∑–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–π</p>
            </div>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-value">${window.gdData.players.length}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${window.gdData.challenges.length}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${Math.max(...window.gdData.players.map(p => p.challengePoints))}</div>
                    <div class="stat-label">–ú–∞–∫—Å–∏–º—É–º –æ—á–∫–æ–≤</div>
                </div>
            </div>
            
            <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
            <div class="search-container">
                <input type="text" id="player-search" placeholder="–ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–æ–≤...">
                <button id="search-btn">–ù–∞–π—Ç–∏</button>
            </div>
            
            <div class="filter-container">
                <button class="filter-btn active" data-filter="all">–í—Å–µ –∏–≥—Ä–æ–∫–∏</button>
                <button class="filter-btn" data-filter="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</button>
                <button class="filter-btn" data-filter="top-5">–¢–æ–ø-5 –∏–≥—Ä–æ–∫–æ–≤</button>
                <button class="filter-btn" data-filter="completed-all">–ü—Ä–æ—à–ª–∏ –≤—Å–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è</button>
            </div>
            
            <div id="challenge-players-container">
                <!-- –ò–≥—Ä–æ–∫–∏ –≤ –∏—Å–ø—ã—Ç–∞–Ω–∏—è—Ö –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </main>
    </div>

    <script src="data.js"></script>
    <script>
        function renderChallengePlayers(players = window.gdData.players) {
            const container = document.getElementById('challenge-players-container');
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –æ—á–∫–∞–º –≤ –∏—Å–ø—ã—Ç–∞–Ω–∏—è—Ö
            const sortedPlayers = [...players].sort((a, b) => b.challengePoints - a.challengePoints);
            
            if (sortedPlayers.length === 0) {
                container.innerHTML = `
                    <div class="no-results">
                        <h3>–ò–≥—Ä–æ–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = sortedPlayers.map((player, index) => `
                <div class="player-item challenge-player">
                    <div class="player-rank">
                        ${index + 1}
                        ${index < 3 ? '<span class="top-badge">üèÜ</span>' : ''}
                    </div>
                    <div class="player-info">
                        <div class="player-name">
                            ${player.name}
                            ${player.isAdmin ? '<span class="admin-badge">–ê–¥–º–∏–Ω</span>' : ''}
                        </div>
                        <div class="player-stats">
                            <span class="challenge-stat">–ò—Å–ø—ã—Ç–∞–Ω–∏–π: ${player.challenges}</span>
                            <span class="challenge-stat">–û—á–∫–∏: ${player.challengePoints}</span>
                            <span class="challenge-stat">–†–µ–π—Ç–∏–Ω–≥: ${player.challengeRank}</span>
                            <span class="completion-rate">–ü—Ä–æ–≥—Ä–µ—Å—Å: ${Math.round((player.challenges / window.gdData.challenges.length) * 100)}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${(player.challenges / window.gdData.challenges.length) * 100}%"></div>
                        </div>
                        <div class="passed-levels">
                            <strong>–ü—Ä–æ–π–¥–µ–Ω–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è:</strong>
                            ${player.passedChallenges.map(challengeId => {
                                const challenge = window.gdData.challenges.find(c => c.id === challengeId);
                                return challenge ? `<span class="challenge-tag">#${challenge.rank} ${challenge.name}</span>` : '';
                            }).filter(Boolean).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // –ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–æ–≤
        function setupPlayerSearch() {
            const searchInput = document.getElementById('player-search');
            const searchBtn = document.getElementById('search-btn');
            
            function performSearch() {
                const query = searchInput.value.trim();
                if (query === '') {
                    renderChallengePlayers();
                } else {
                    const filteredPlayers = window.gdData.searchPlayers(query);
                    renderChallengePlayers(filteredPlayers);
                }
            }
            
            searchBtn.addEventListener('click', performSearch);
            searchInput.addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    performSearch();
                }
            });
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤
        function setupPlayerFilters() {
            const filterBtns = document.querySelectorAll('.filter-btn');
            
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                    filterBtns.forEach(b => b.classList.remove('active'));
                    // –î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
                    this.classList.add('active');
                    
                    const filter = this.dataset.filter;
                    let filteredPlayers = [...window.gdData.players];
                    
                    switch(filter) {
                        case 'admin':
                            filteredPlayers = filteredPlayers.filter(player => player.isAdmin);
                            break;
                        case 'top-5':
                            filteredPlayers = filteredPlayers
                                .sort((a, b) => b.challengePoints - a.challengePoints)
                                .slice(0, 5);
                            break;
                        case 'completed-all':
                            filteredPlayers = filteredPlayers.filter(player => 
                                player.challenges === window.gdData.challenges.length
                            );
                            break;
                        default:
                            // "all" - –Ω–∏—á–µ–≥–æ –Ω–µ —Ñ–∏–ª—å—Ç—Ä—É–µ–º
                            break;
                    }
                    
                    renderChallengePlayers(filteredPlayers);
                });
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            const totalPlayers = window.gdData.players.length;
            const totalChallenges = window.gdData.challenges.length;
            const maxPoints = Math.max(...window.gdData.players.map(p => p.challengePoints));
            
            document.querySelector('.stats-container').innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${totalPlayers}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${totalChallenges}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${maxPoints}</div>
                    <div class="stat-label">–ú–∞–∫—Å–∏–º—É–º –æ—á–∫–æ–≤</div>
                </div>
            `;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ DOM
        document.addEventListener('DOMContentLoaded', function() {
            if (window.gdData) {
                updateStats();
                renderChallengePlayers();
                setupPlayerSearch();
                setupPlayerFilters();
            }
        });
    </script>
</body>
</html>